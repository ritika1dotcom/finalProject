{% extends "base.html" %}

{% block content %}
  <h1 class="text-xl font-bold">Recommended Songs for {{ user_obj.username }}</h1>
  <h2 class="text-lg font-semibold py-5">Playlist Recommendation Generated using Apriori Algorithm</h2>

  <div id="recommended-songs-table">
    <div class="w-[200px]">
      {% if recommendations %}
        {% for recommendation in recommendations %}
          <div class="flex flex-row gap-5 py-2">
            <img
              src="{{ recommendation.song_details.album_image }}"
              alt="{{ recommendation.song }}"
              width="100"
              height="50"
            />
            <div>
              <p class="text-xl font-bold">{{ recommendation.song }}</p>
              <p class="text-lg font-semibold">Artist Name: {{ recommendation.song_details.artist_name }}</p>
            </div>
          </div>
        {% endfor %}
      {% else %}
        <p>No recommendations available. Here's a random playlist:</p>
        {% for random_song in random_recommendations %}
          <div class="flex flex-row gap-5 py-2">
            <img
              src="{{ random_song.song_details.album_image }}"
              alt="{{ random_song.song }}"
              width="100"
              height="50"
            />
            <div>
              <p class="text-xl font-bold">{{ random_song.song }}</p>
              <p class="text-lg font-semibold">Artist Name: {{ random_song.song_details.artist_name }}</p>
            </div>
          </div>
        {% endfor %}
      {% endif %}
    </div>
  </div>

  <h2>User-Song Play Count Data</h2>

  <table  id="playCountTable" class="display">
    <thead>
        <tr>
            <th>User ID</th>
            <th>Song ID</th>
            <th>Play Count</th>
        </tr>
    </thead>
    <tbody>
        {% for entry in user_song_list %}
            <tr>
                <td>{{ entry.user_id }}</td>
                <td>{{ entry.song_id }}</td>
                <td>{{ entry.play_count }}</td>
            </tr>
        {% endfor %}
    </tbody>
</table>
    <script>
      $(document).ready(function() {
          // Initialize DataTable
          $('#playCountTable').DataTable();
      });
  </script>

{% endblock %}
